(window.webpackJsonp=window.webpackJsonp||[]).push([[127],{929:function(e,t,o){"use strict";o.r(t);var r=o(108),l=o(130),n=o(101),c=o(420),d=o(850),h=o(667),k=o(736),v=o(141),m=o(195),f=o(419),x=o(710),y=o(200),w=o(11),_=o(33),C=o(47),P=(o(142),o(7),o(54),o(57),o(12),o(35),o(45),o(74),o(114),o(13),o(298)),U={components:{TiptapVuetify:P.o},layout:"dashboard",middleware:["auth"],data:function(){return{extensions:[P.g,P.a,P.j,P.q,P.n,P.i,P.k,P.c,P.l,[P.f,{options:{levels:[2,3]}}],P.b,P.j,P.h,P.m,P.e],title:null,content:"<blockquote>Writing is the only way to change the world without leaving bed - Lenang Manggala </blockquote>",categories:[],categorySelected:1,tags:null,bookTitle:null,bookAuthor:null,bookPage:null,bookPublisher:null,stateUpload:{pathField:{name:"path",value:"artikel"},fileField:{name:"picture",value:""},uploadPercentage:0,response:null},imageRules:[function(e){return!e||e.size<2e6||"Image size should be less than 2 MB!"}],isCategorySastra:!1}},fetch:function(){var e=this;return Object(C.a)(regeneratorRuntime.mark((function t(){var o,r,l,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.articleId=e.$route.params.slug,t.next=3,Promise.all([e.$axios.$get("/api/v1/general/articlecategory"),e.$axios.$get("/api/v1/article/detail",{params:{id:e.articleId,action:"edit"}})]);case 3:o=t.sent,r=Object(_.a)(o,2),l=r[0],n=r[1],l.result&&l.result.data.forEach((function(t){e.categories.push({value:t.CategoryId,text:t.CategoryName})})),e.setFormEdit(n.result);case 9:case"end":return t.stop()}}),t)})))()},head:function(){return{title:"Edit Tulisan - pustakabergerak.id"}},watch:{categorySelected:function(e,t){this.isCategorySastra=2===parseInt(e)}},methods:{setFormEdit:function(e){this.title=e.data.Title,this.content=e.data.Content,this.categorySelected=e.data.CategoryId,this.tags=e.data.Hashtag?e.data.Hashtag.split(","):[],this.bookTitle=e.data.BookTitle,this.bookAuthor=e.data.BookAuthor,this.bookPage=e.data.BookPage,this.bookPublisher=e.data.BookPublisher,this.stateUpload.response=e.data.Cover?{picture:{name:e.data.Cover,url:"".concat("https://image-uploader.pustakabergerak.id/public","/storage/artikel/").concat(e.data.Cover)}}:null},upload:function(e){var t=this;return Object(C.a)(regeneratorRuntime.mark((function o(){var r,l,n,c,d,h,element;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return t.stateUpload.fileField.value=e,t.stateUpload.uploadPercentage=0,(r=new FormData).append(t.stateUpload.fileField.name,t.stateUpload.fileField.value),t.stateUpload.pathField.value&&r.append(t.stateUpload.pathField.name,t.stateUpload.pathField.value),l={headers:{"Content-Type":"multipart/form-data"},onUploadProgress:function(e){t.stateUpload.uploadPercentage=Math.round(100*e.loaded/e.total)}},o.prev=6,o.next=9,t.$axios.post("".concat("https://image-uploader.pustakabergerak.id/public","/api/upload"),r,l);case 9:200===(n=o.sent).status&&(t.stateUpload.response=n.data,t.$toast.success("Upload Success")),o.next=18;break;case 13:for(o.prev=13,o.t0=o.catch(6),c=o.t0.response.data.errors.picture,d=o.t0.response.data.message,h=0;h<c.length;h++)element=c[h],t.$toast.error(d+" "+element,{duration:1e4});case 18:t.stateUpload.uploadPercentage=0;case 19:case"end":return o.stop()}}),o,null,[[6,13]])})))()},submit:function(e){var t=this;return Object(C.a)(regeneratorRuntime.mark((function o(){var r,l,n,c,d,h;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return l={title:t.title,content:t.content,category:t.categorySelected,tag:null===(r=t.tags)||void 0===r?void 0:r.join(",").toString(),book_title:t.bookTitle,book_author:t.bookAuthor,book_page:t.bookPage,book_publisher:t.bookPublisher,status:e,cover:t.stateUpload.response?t.stateUpload.response.picture.name:null},o.prev=1,o.next=4,t.$axios.$post("/api/v1/article/store?id=".concat(t.articleId),l);case 4:if((n=o.sent).status)t.$toast.success("Tulisan berhasil ditambahkan ke dalam ".concat(e)),"Draft"===e&&t.$router.push("/gerakanku/tulisan/".concat(n.result.data,"/edit")),"Review"===e&&t.$router.push("/gerakanku/tulisan");else if("object"===Object(w.a)(n.error))for(c=0,d=Object.keys(n.error);c<d.length;c++)h=d[c],t.$toast.error(n.error[h]);else t.$toast.error(n.error);o.next=11;break;case 8:o.prev=8,o.t0=o.catch(1),t.$toast.error(o.t0);case 11:case"end":return o.stop()}}),o,null,[[1,8]])})))()}}},S=o(28),component=Object(S.a)(U,(function(){var e=this,t=e._self._c;return t(f.a,[t(c.a,{attrs:{cols:"12"}},[t(l.a,{staticClass:"pa-4",attrs:{outlined:"",rounded:"xl"}},[t(n.d,[e._v(" Edit Tulisan ")]),e._v(" "),t(h.a,[t(f.a,[t(c.a,{attrs:{cols:"12"}},[t(y.a,{staticClass:"pa-0 ma-0 rounded-lg",attrs:{color:"light-green darken-3",type:"text",outlined:"",label:"Judul"},model:{value:e.title,callback:function(t){e.title=t},expression:"title"}})],1),e._v(" "),t(c.a,{attrs:{cols:"12"}},[t(x.a,{staticClass:"pa-0 ma-0 rounded-lg",attrs:{color:"light-green darken-3",type:"text",outlined:"",label:"Kategori Tulisan",items:e.categories},model:{value:e.categorySelected,callback:function(t){e.categorySelected=t},expression:"categorySelected"}}),e._v(" "),t(l.a,{directives:[{name:"show",rawName:"v-show",value:e.isCategorySastra,expression:"isCategorySastra"}],staticClass:"pa-4",attrs:{outlined:"",rounded:"xl"}},[t(f.a,[t(c.a,{attrs:{cols:"6"}},[t(y.a,{staticClass:"pa-0 ma-0 rounded-lg",attrs:{color:"light-green darken-3",type:"text",outlined:"",dense:"",label:"Judul Buku"},model:{value:e.bookTitle,callback:function(t){e.bookTitle=t},expression:"bookTitle"}})],1),e._v(" "),t(c.a,{attrs:{cols:"6"}},[t(y.a,{staticClass:"pa-0 ma-0 rounded-lg",attrs:{color:"light-green darken-3",type:"text",outlined:"",dense:"",label:"Judul Pengarang"},model:{value:e.bookAuthor,callback:function(t){e.bookAuthor=t},expression:"bookAuthor"}})],1),e._v(" "),t(c.a,{attrs:{cols:"6"}},[t(y.a,{staticClass:"pa-0 ma-0 rounded-lg",attrs:{color:"light-green darken-3",type:"text",outlined:"",dense:"",label:"Halaman"},model:{value:e.bookPage,callback:function(t){e.bookPage=t},expression:"bookPage"}})],1),e._v(" "),t(c.a,{attrs:{cols:"6"}},[t(y.a,{staticClass:"pa-0 ma-0 rounded-lg",attrs:{color:"light-green darken-3",type:"text",outlined:"",dense:"",label:"Penerbit"},model:{value:e.bookPublisher,callback:function(t){e.bookPublisher=t},expression:"bookPublisher"}})],1)],1)],1)],1),e._v(" "),t(c.a,{attrs:{cols:"12"}},[t("ClientOnly",{scopedSlots:e._u([{key:"placeholder",fn:function(){return[e._v(" Loading... ")]},proxy:!0}])},[t("tiptap-vuetify",{attrs:{extensions:e.extensions},model:{value:e.content,callback:function(t){e.content=t},expression:"content"}})],1)],1),e._v(" "),t(c.a,{attrs:{cols:"12",lg:"8"}},[t(d.a,{staticClass:"rounded-lg",attrs:{label:"Hashtag (tanpa #)",multiple:"",outlined:"","deletable-chips":"","small-chips":"",color:"light-green darken-3"},model:{value:e.tags,callback:function(t){e.tags=t},expression:"tags"}})],1),e._v(" "),t(c.a,{attrs:{cols:"12",lg:"4"}},[t(k.a,{staticClass:"rounded-lg",attrs:{rules:e.imageRules,accept:"image/png, image/jpeg, image/jpg",label:"Sampul Tulisan",color:"light-green darken-3",outlined:"","background-color":"white","show-size":"",loading:e.stateUpload.uploadPercentage>0,"loader-height":"6"},on:{change:e.upload}})],1),e._v(" "),t(c.a,{attrs:{cols:"12"}},[e.stateUpload.response?t(m.a,{attrs:{src:e.stateUpload.response.picture.url,height:e.isMobile?"200px":"370px"}}):t("div",{staticClass:"d-flex flex-column justify-center align-center grey lighten-3 tw-min-h-[200px] tw-h-[200px] rounded-xl"},[t(v.a,{attrs:{size:"100",color:"grey"}},[e._v("mdi-image-area")]),e._v(" "),t("div",{staticClass:"caption text-secondary"},[e._v("\n                (Preview image goes here)\n              ")])],1)],1),e._v(" "),t(c.a,{attrs:{cols:"12"}},[t("div",{staticClass:"tw-flex tw-justify-between"},[t(r.a,{attrs:{to:"/gerakanku/tulisan",nuxt:""}},[e._v("Kembali")]),e._v(" "),t("div",{staticClass:"tw-flex tw-space-x-2"},[t(r.a,{on:{click:function(t){return e.submit("Draft")}}},[t(v.a,{attrs:{left:""}},[e._v("mdi-file")]),e._v("\n                  Simpan ke draft\n                ")],1),e._v(" "),t(r.a,{attrs:{color:"light-green darken-3",dark:""},on:{click:function(t){return e.submit("Review")}}},[t(v.a,{attrs:{left:""}},[e._v("mdi-send")]),e._v("\n                  Publikasikan\n                ")],1)],1)],1)])],1)],1)],1)],1)],1)}),[],!1,null,null,null);t.default=component.exports}}]);